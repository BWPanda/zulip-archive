---
layout: archive
title: Zulip Chat Archive
permalink: /stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html
---

<h2>Stream: <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/index.html">Backdrop</a></h2>
<h3>Topic: <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html">CKEditor maximize bug</a></h3>

<hr>

<base href="backdrop.zulipchat.com">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="230346225"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230346225" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> indigoxela <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230346225">(Mar 15 2021 at 13:46)</a>:</h4>
<p>Found the reason! <a href="https://github.com/backdrop/backdrop-issues/issues/4933">https://github.com/backdrop/backdrop-issues/issues/4933</a> Now we only need a solution for it. <span aria-label="smiling devil" class="emoji emoji-1f608" role="img" title="smiling devil">:smiling_devil:</span></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/backdrop/backdrop-issues/issues/4933" style="background-image: url(https://avatars.githubusercontent.com/u/5283039?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/backdrop/backdrop-issues/issues/4933" title="Unable to save page after using CKEditor &quot;Maximize&quot; mode 路 Issue #4933 路 backdrop/backdrop-issues">Unable to save page after using CKEditor "Maximize" mode 路 Issue #4933 路 backdrop/backdrop-issues</a></div><div class="message_embed_description">Description of the bug Sometimes I&#39;m not able to save a page after editing the body text in CKEditor. After hitting the &quot;Save&quot; button of the page edit form, the editor area changes: b...</div></div></div>



<a name="230349778"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230349778" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olaf Grabienski <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230349778">(Mar 15 2021 at 14:07)</a>:</h4>
<p>Interesting, thanks for the research! (Unfortunately, I don't have any the needed JS skills.)</p>



<a name="230354993"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230354993" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> indigoxela <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230354993">(Mar 15 2021 at 14:39)</a>:</h4>
<p>But this at least means, that you have a workaround for your client sites - just comment that single line and saving after using "maximize" works again. (And also double-click on form buttons, which this line tries to prevent).</p>



<a name="230377282"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230377282" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> quicksketch <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230377282">(Mar 15 2021 at 16:27)</a>:</h4>
<p>Wow nice sleuthing <span class="user-mention" data-user-id="256738">@indigoxela</span>!</p>



<a name="230377808"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230377808" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> docwilmot <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230377808">(Mar 15 2021 at 16:30)</a>:</h4>
<p>Indeed. I just had a look, and it seems that once you've maximized then selected an image, any click of the node form "Save" button fires the submit handler twice, hence <code>Backdrop.behaviors.formSingleSubmit.onFormSubmit()</code> fires twice, and prevents default</p>



<a name="230377980"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230377980" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> docwilmot <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230377980">(Mar 15 2021 at 16:32)</a>:</h4>
<p>FYI <code> e.stopImmediatePropagation();</code> at the start of that function fixes the problem without figuring out why it fires twice. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="230429024"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230429024" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olaf Grabienski <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230429024">(Mar 15 2021 at 22:15)</a>:</h4>
<blockquote>
<p><code>e.stopImmediatePropagation();</code> at the start of that function fixes the problem ...</p>
</blockquote>
<p><span class="user-mention" data-user-id="256757">@docwilmot</span>, I'd like to test this; "that function" would be the following?</p>
<div class="codehilite"><pre><span></span><code>function onFormSubmit (e) {
      if (e.isDefaultPrevented()) {
        // Don&#39;t act on form submissions that have been prevented by other JS.
        return;
      }
</code></pre></div>
<p>(<a href="https://github.com/backdrop/backdrop/blob/72b071a1842d9b745fc0fa28c069b20c6260984b/core/misc/form.js#L100">https://github.com/backdrop/backdrop/blob/72b071a1842d9b745fc0fa28c069b20c6260984b/core/misc/form.js#L100</a>)</p>
<p>And what does "at the start" exactly mean? Sorry for limited understanding.</p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/backdrop/backdrop/blob/72b071a1842d9b745fc0fa28c069b20c6260984b/core/misc/form.js#L100" style="background-image: url(https://avatars.githubusercontent.com/u/5283039?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/backdrop/backdrop/blob/72b071a1842d9b745fc0fa28c069b20c6260984b/core/misc/form.js#L100" title="backdrop/backdrop">backdrop/backdrop</a></div><div class="message_embed_description">Backdrop core code repository. Contribute to backdrop/backdrop development by creating an account on GitHub.</div></div></div>



<a name="230432483"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230432483" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> docwilmot <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230432483">(Mar 15 2021 at 22:37)</a>:</h4>
<p>At the start of the function that <span class="user-mention" data-user-id="256738">@indigoxela</span> linked to: <a href="https://github.com/backdrop/backdrop/blob/72b071a1842d9b745fc0fa28c069b20c6260984b/core/misc/form.js#L109">https://github.com/backdrop/backdrop/blob/72b071a1842d9b745fc0fa28c069b20c6260984b/core/misc/form.js#L109</a></p>
<div class="message_embed"><a class="message_embed_image" href="https://github.com/backdrop/backdrop/blob/72b071a1842d9b745fc0fa28c069b20c6260984b/core/misc/form.js#L109" style="background-image: url(https://avatars.githubusercontent.com/u/5283039?s=400&amp;v=4)"></a><div class="data-container"><div class="message_embed_title"><a href="https://github.com/backdrop/backdrop/blob/72b071a1842d9b745fc0fa28c069b20c6260984b/core/misc/form.js#L109" title="backdrop/backdrop">backdrop/backdrop</a></div><div class="message_embed_description">Backdrop core code repository. Contribute to backdrop/backdrop development by creating an account on GitHub.</div></div></div>



<a name="230432595"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230432595" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> docwilmot <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230432595">(Mar 15 2021 at 22:38)</a>:</h4>
<p>So</p>
<div class="codehilite"><pre><span></span><code> * Lastly, all forms submitted via HTTP GET are idempotent by definition of HTTP
 * standards, so excluded in this implementation.
 */
Backdrop.behaviors.formSingleSubmit = {
  attach: function () {
    function onFormSubmit (e) {
      e.stopImmediatePropagation();
      if (e.isDefaultPrevented()) {
        // Don&#39;t act on form submissions that have been prevented by other JS.
        return;
      }
      var $form = $(e.currentTarget);
etc
</code></pre></div>



<a name="230432663"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230432663" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> docwilmot <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230432663">(Mar 15 2021 at 22:39)</a>:</h4>
<p>I did wonder tho after posting if that line would actually stop the function from doing its job</p>



<a name="230432676"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230432676" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> docwilmot <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230432676">(Mar 15 2021 at 22:39)</a>:</h4>
<p>Didnt test</p>



<a name="230432742"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230432742" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olaf Grabienski <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230432742">(Mar 15 2021 at 22:39)</a>:</h4>
<p>Thank you! I'll try to test it tomorrow.</p>



<a name="230432804"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230432804" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> docwilmot <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230432804">(Mar 15 2021 at 22:40)</a>:</h4>
<p>(the function is meant to prevent doubleclick the node save button from double submitting the node form)</p>



<a name="230466546"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230466546" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> indigoxela <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230466546">(Mar 16 2021 at 06:48)</a>:</h4>
<p>I did some quick checks yesterday, when <span class="user-mention" data-user-id="256757">@docwilmot</span> posted his suggestion - double clicks are still prevented properly. <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> Hm, no PR yet? I'll give it a stab.</p>
<p>BTW: this team workflow is soooo... Backdrop <span aria-label="heart eyes" class="emoji emoji-1f60d" role="img" title="heart eyes">:heart_eyes:</span></p>



<a name="230502951"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230502951" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> docwilmot <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230502951">(Mar 16 2021 at 12:26)</a>:</h4>
<p>I didnt think this was <em>the</em> solution to be honest. I wonder if we should figure out why the submit button fires twice. Would that cause any handlers to fire twice?</p>



<a name="230503887"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230503887" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> indigoxela <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230503887">(Mar 16 2021 at 12:34)</a>:</h4>
<p>Figuring out the reason, why "Maximize" seems to cause an additional event listener, would definitely be the cherry on top. That's over my head, though.</p>



<a name="230529130"></a>
<h4><a href="backdrop.zulipchat.com#narrow/stream/218635-Backdrop/topic/CKEditor%20maximize%20bug/near/230529130" class="zl"><img src="https://bwpanda.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Olaf Grabienski <a href="https://bwpanda.github.io/zulip-archive/stream/218635-Backdrop/topic/CKEditor.20maximize.20bug.html#230529130">(Mar 16 2021 at 15:09)</a>:</h4>
<p>Tested PR in the sandbox, works for me!</p>



{% endraw %}

<hr><p>Last updated: Apr 05 2021 at 23:47 UTC</p>